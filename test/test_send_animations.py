import json
import time

import paho.mqtt.client as mqtt

from network.send_to_mqtt import start_song
from thing_to_obj_map import obj_to_thing

host_name = "10.0.0.200"
sender_mqtt_client_id = "leds-seq-creator"

client = mqtt.Client(sender_mqtt_client_id)
client.connect(host_name)

filename = "alterego"

for _ in range(100):
    for led_object, thing_name in obj_to_thing.items():
        # json_str = """[{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0},{"t":"const","p":"a","s":0,"e":468292,"params":{"hsv":[0.7,1.0,0.2]}},{"t":"brightness","p":"a","s":0,"e":468292,"params":{"brightness":{"t":"sin","min":0.4,"max":1.0,"phase":-0.25,"rep":1}},"rep_s":0.0,"rep_e":1.0,"rep_num":960.0}]"""
        json_str = """[]"""
        print("sending json of size {} to thing {}".format(len(json_str), thing_name))
        print(json_str)
        client.publish("animations/{}/{}".format(thing_name, filename), json_str, qos=1)
    start_song("alterego", 0)
    time.sleep(5)
